const mongoose = require('mongoose');
const axios = require('axios');
const turf = require('@turf/turf');
const Bus = require('./models/bus.model');
require('dotenv').config();

const busData = [
    { "busNumber": "BUS-PN01-1234", "source": { "name": "Amritsar", "coords": [31.6339, 74.8722] }, "destination": { "name": "Ludhiana", "coords": [30.9010, 75.8573] }, "departureTime": "08:00", "arrivalTime": "11:00", "driverName": "Mr. Singh", "stops": [ { "name": "Jandiala", "coords": [31.5583, 75.0258] }, { "name": "Beas", "coords": [31.5177, 75.2916] }, { "name": "Kartarpur", "coords": [31.4426, 75.4984] }, { "name": "Phagwara", "coords": [31.2181, 75.7725] }, { "name": "Phillaur", "coords": [31.0261, 75.7863] } ] },
    { "busNumber": "BUS-GJ05-5678", "source": { "name": "Jalandhar", "coords": [31.3260, 75.5762] }, "destination": { "name": "Patiala", "coords": [30.3398, 76.3869] }, "departureTime": "09:30", "arrivalTime": "12:00", "driverName": "Mr. Sharma", "stops": [ { "name": "Phagwara", "coords": [31.2181, 75.7725] }, { "name": "Sirhind", "coords": [30.6210, 76.3888] }, { "name": "Rajpura", "coords": [30.4807, 76.5919] } ] },
    { "busNumber": "BUS-PN01-5555", "source": { "name": "Amritsar", "coords": [31.6339, 74.8722] }, "destination": { "name": "Ludhiana", "coords": [30.9010, 75.8573] }, "departureTime": "10:00", "arrivalTime": "13:00", "driverName": "Mr. Gupta", "stops": [ { "name": "Beas", "coords": [31.5177, 75.2916] }, { "name": "Jalandhar", "coords": [31.3260, 75.5762] }, { "name": "Phagwara", "coords": [31.2181, 75.7725] }, { "name": "Goraya", "coords": [31.1290, 75.7660] } ] },
    { "busNumber": "BUS-PB08-1111", "source": { "name": "Patiala", "coords": [30.3398, 76.3869] }, "destination": { "name": "Amritsar", "coords": [31.6339, 74.8722] }, "departureTime": "11:30", "arrivalTime": "15:00", "driverName": "Mr. Verma", "stops": [ { "name": "Sirhind", "coords": [30.6210, 76.3888] }, { "name": "Ludhiana", "coords": [30.9010, 75.8573] }, { "name": "Jalandhar", "coords": [31.3260, 75.5762] }, { "name": "Beas", "coords": [31.5177, 75.2916] } ] },
    { "busNumber": "BUS-PB08-2222", "source": { "name": "Moga", "coords": [30.8038, 75.1713] }, "destination": { "name": "Faridkot", "coords": [30.6752, 74.7543] }, "departureTime": "12:00", "arrivalTime": "13:30", "driverName": "Mr. Kumar", "stops": [ { "name": "Kot Ise Khan", "coords": [30.9012, 75.0312] }, { "name": "Talwandi Bhai", "coords": [30.7936, 74.9581] } ] },
    { "busNumber": "BUS-PN23-8888", "source": { "name": "Bathinda", "coords": [30.2110, 74.9455] }, "destination": { "name": "Sangrur", "coords": [30.2526, 75.8378] }, "departureTime": "07:45", "arrivalTime": "09:15", "driverName": "Mr. Reddy", "stops": [ { "name": "Rampura Phul", "coords": [30.2641, 75.2415] }, { "name": "Barnala", "coords": [30.3782, 75.5422] }, { "name": "Dhuri", "coords": [30.3671, 75.8679] } ] },
    { "busNumber": "BUS-PN10-7777", "source": { "name": "Ludhiana", "coords": [30.9010, 75.8573] }, "destination": { "name": "Jalandhar", "coords": [31.3260, 75.5762] }, "departureTime": "14:00", "arrivalTime": "15:30", "driverName": "Mr. Patel", "stops": [ { "name": "Phillaur", "coords": [31.0261, 75.7863] }, { "name": "Goraya", "coords": [31.1290, 75.7660] }, { "name": "Phagwara", "coords": [31.2181, 75.7725] } ] },
    { "busNumber": "BUS-CH01-3333", "source": { "name": "Mohali", "coords": [30.7042, 76.7179] }, "destination": { "name": "Ropar", "coords": [30.9660, 76.5250] }, "departureTime": "15:00", "arrivalTime": "16:00", "driverName": "Mr. Khan", "stops": [ { "name": "Kharar", "coords": [30.7444, 76.6499] }, { "name": "Kurali", "coords": [30.8350, 76.5700] } ] },
     { "busNumber": "BUS-PB65-4444", "source": { "name": "Pathankot", "coords": [32.2687, 75.6496] }, "destination": { "name": "Gurdaspur", "coords": [32.0428, 75.4057] }, "departureTime": "16:30", "arrivalTime": "17:30", "driverName": "Mr. Joshi", "stops": [ { "name": "Dinanagar", "coords": [32.1447, 75.4853] } ] },
     { "busNumber": "BUS-PB13-6666", "source": { "name": "Sangrur", "coords": [30.2526, 75.8378] }, "destination": { "name": "Barnala", "coords": [30.3782, 75.5422] }, "departureTime": "10:30", "arrivalTime": "11:30", "driverName": "Mr. Desai", "stops": [ { "name": "Dhuri", "coords": [30.3671, 75.8679] } ] },
     { "busNumber": "BUS-PN01-1235", "source": { "name": "Amritsar", "coords": [31.6339, 74.8722] }, "destination": { "name": "Jalandhar", "coords": [31.3260, 75.5762] }, "departureTime": "08:30", "arrivalTime": "10:00", "driverName": "Mr. Menon", "stops": [ { "name": "Beas", "coords": [31.5177, 75.2916] }, { "name": "Kartarpur", "coords": [31.4426, 75.4984] } ] },
     { "busNumber": "BUS-GJ05-5679", "source": { "name": "Patiala", "coords": [30.3398, 76.3869] }, "destination": { "name": "Ludhiana", "coords": [30.9010, 75.8573] }, "departureTime": "11:00", "arrivalTime": "12:30", "driverName": "Mr. Iyer", "stops": [ { "name": "Sirhind", "coords": [30.6210, 76.3888] }, { "name": "Khanna", "coords": [30.7027, 76.2223] }, { "name": "Doraha", "coords": [30.8000, 76.0200] } ] },
     { "busNumber": "BUS-PN01-5556", "source": { "name": "Ludhiana", "coords": [30.9010, 75.8573] }, "destination": { "name": "Amritsar", "coords": [31.6339, 74.8722] }, "departureTime": "13:30", "arrivalTime": "16:30", "driverName": "Mr. Nair", "stops": [ { "name": "Phillaur", "coords": [31.0261, 75.7863] }, { "name": "Jalandhar", "coords": [31.3260, 75.5762] }, { "name": "Beas", "coords": [31.5177, 75.2916] } ] },
     { "busNumber": "BUS-PB08-1112", "source": { "name": "Amritsar", "coords": [31.6339, 74.8722] }, "destination": { "name": "Patiala", "coords": [30.3398, 76.3869] }, "departureTime": "14:30", "arrivalTime": "18:00", "driverName": "Mr. Rao", "stops": [ { "name": "Jalandhar", "coords": [31.3260, 75.5762] }, { "name": "Ludhiana", "coords": [30.9010, 75.8573] }, { "name": "Sirhind", "coords": [30.6210, 76.3888] } ] },
     { "busNumber": "BUS-PB08-2223", "source": { "name": "Faridkot", "coords": [30.6752, 74.7543] }, "destination": { "name": "Moga", "coords": [30.8038, 75.1713] }, "departureTime": "09:00", "arrivalTime": "10:30", "driverName": "Mr. Pillai", "stops": [ { "name": "Kotkapura", "coords": [30.5841, 74.8217] }, { "name": "Baghapurana", "coords": [30.6773, 75.0805] } ] },
     { "busNumber": "BUS-PN23-8889", "source": { "name": "Sangrur", "coords": [30.2526, 75.8378] }, "destination": { "name": "Bathinda", "coords": [30.2110, 74.9455] }, "departureTime": "17:00", "arrivalTime": "18:30", "driverName": "Mr. Chawla", "stops": [ { "name": "Barnala", "coords": [30.3782, 75.5422] }, { "name": "Rampura Phul", "coords": [30.2641, 75.2415] } ] },
     { "busNumber": "BUS-PN10-7778", "source": { "name": "Jalandhar", "coords": [31.3260, 75.5762] }, "destination": { "name": "Ludhiana", "coords": [30.9010, 75.8573] }, "departureTime": "18:00", "arrivalTime": "19:30", "driverName": "Mr. Bedi", "stops": [ { "name": "Phagwara", "coords": [31.2181, 75.7725] }, { "name": "Goraya", "coords": [31.1290, 75.7660] }, { "name": "Phillaur", "coords": [31.0261, 75.7863] } ] },
     { "busNumber": "BUS-CH01-3334", "source": { "name": "Ropar", "coords": [30.9660, 76.5250] }, "destination": { "name": "Mohali", "coords": [30.7042, 76.7179] }, "departureTime": "07:00", "arrivalTime": "08:00", "driverName": "Mr. Puri", "stops": [ { "name": "Kurali", "coords": [30.8350, 76.5700] }, { "name": "Kharar", "coords": [30.7444, 76.6499] } ] },
     { "busNumber": "BUS-PB65-4445", "source": { "name": "Gurdaspur", "coords": [32.0428, 75.4057] }, "destination": { "name": "Pathankot", "coords": [32.2687, 75.6496] }, "departureTime": "19:00", "arrivalTime": "20:00", "driverName": "Mr. Sood", "stops": [ { "name": "Dinanagar", "coords": [32.1447, 75.4853] } ] },
     { "busNumber": "BUS-PB13-6667", "source": { "name": "Barnala", "coords": [30.3782, 75.5422] }, "destination": { "name": "Sangrur", "coords": [30.2526, 75.8378] }, "departureTime": "13:00", "arrivalTime": "14:00", "driverName": "Mr. Tandon", "stops": [ { "name": "Dhuri", "coords": [30.3671, 75.8679] } ] },
     { "busNumber": "BUS-PN01-1236", "source": { "name": "Amritsar", "coords": [31.6339, 74.8722] }, "destination": { "name": "Bathinda", "coords": [30.2110, 74.9455] }, "departureTime": "09:00", "arrivalTime": "13:00", "driverName": "Mr. Mehra", "stops": [ { "name": "Tarn Taran", "coords": [31.4503, 74.9259] }, { "name": "Harike", "coords": [31.1500, 74.9333] }, { "name": "Faridkot", "coords": [30.6752, 74.7543] }, { "name": "Kotkapura", "coords": [30.5841, 74.8217] } ] },
     { "busNumber": "BUS-GJ05-5680", "source": { "name": "Jalandhar", "coords": [31.3260, 75.5762] }, "destination": { "name": "Mohali", "coords": [30.7042, 76.7179] }, "departureTime": "10:30", "arrivalTime": "13:30", "driverName": "Mr. Khanna", "stops": [ { "name": "Phagwara", "coords": [31.2181, 75.7725] }, { "name": "Ludhiana", "coords": [30.9010, 75.8573] }, { "name": "Sirhind", "coords": [30.6210, 76.3888] } ] },
     { "busNumber": "BUS-PN01-5557", "source": { "name": "Ludhiana", "coords": [30.9010, 75.8573] }, "destination": { "name": "Sangrur", "coords": [30.2526, 75.8378] }, "departureTime": "12:00", "arrivalTime": "14:00", "driverName": "Mr. Bajaj", "stops": [ { "name": "Malerkotla", "coords": [30.5253, 75.8812] }, { "name": "Dhuri", "coords": [30.3671, 75.8679] } ] },
     { "busNumber": "BUS-PB08-1113", "source": { "name": "Patiala", "coords": [30.3398, 76.3869] }, "destination": { "name": "Moga", "coords": [30.8038, 75.1713] }, "departureTime": "13:30", "arrivalTime": "16:00", "driverName": "Mr. Dhawan", "stops": [ { "name": "Nabha", "coords": [30.3700, 76.1500] }, { "name": "Barnala", "coords": [30.3782, 75.5422] }, { "name": "Baghapurana", "coords": [30.6773, 75.0805] } ] },
     { "busNumber": "BUS-PB08-2224", "source": { "name": "Faridkot", "coords": [30.6752, 74.7543] }, "destination": { "name": "Pathankot", "coords": [32.2687, 75.6496] }, "departureTime": "14:00", "arrivalTime": "19:00", "driverName": "Mr. Kashyap", "stops": [ { "name": "Firozpur", "coords": [30.9231, 74.6067] }, { "name": "Amritsar", "coords": [31.6339, 74.8722] }, { "name": "Gurdaspur", "coords": [32.0428, 75.4057] } ] },
     { "busNumber": "BUS-PN23-8890", "source": { "name": "Bathinda", "coords": [30.2110, 74.9455] }, "destination": { "name": "Barnala", "coords": [30.3782, 75.5422] }, "departureTime": "08:45", "arrivalTime": "10:00", "driverName": "Mr. Gill", "stops": [ { "name": "Rampura Phul", "coords": [30.2641, 75.2415] }, { "name": "Tapa", "coords": [30.3167, 75.4500] } ] },
     { "busNumber": "BUS-PN10-7779", "source": { "name": "Ludhiana", "coords": [30.9010, 75.8573] }, "destination": { "name": "Gurdaspur", "coords": [32.0428, 75.4057] }, "departureTime": "15:00", "arrivalTime": "18:30", "driverName": "Mr. Sethi", "stops": [ { "name": "Jalandhar", "coords": [31.3260, 75.5762] }, { "name": "Pathankot", "coords": [32.2687, 75.6496] } ] },
     { "busNumber": "BUS-CH01-3335", "source": { "name": "Mohali", "coords": [30.7042, 76.7179] }, "destination": { "name": "Faridkot", "coords": [30.6752, 74.7543] }, "departureTime": "16:00", "arrivalTime": "19:00", "driverName": "Mr. Goel", "stops": [ { "name": "Ludhiana", "coords": [30.9010, 75.8573] }, { "name": "Moga", "coords": [30.8038, 75.1713] } ] },
     { "busNumber": "BUS-PB65-4446", "source": { "name": "Pathankot", "coords": [32.2687, 75.6496] }, "destination": { "name": "Ropar", "coords": [30.9660, 76.5250] }, "departureTime": "17:30", "arrivalTime": "21:00", "driverName": "Mr. Jain", "stops": [ { "name": "Hoshiarpur", "coords": [31.5300, 75.9100] }, { "name": "Nawanshahr", "coords": [31.1250, 76.1150] } ] },
     { "busNumber": "BUS-PB13-6668", "source": { "name": "Sangrur", "coords": [30.2526, 75.8378] }, "destination": { "name": "Moga", "coords": [30.8038, 75.1713] }, "departureTime": "11:30", "arrivalTime": "13:30", "driverName": "Mr. Bhatia", "stops": [ { "name": "Barnala", "coords": [30.3782, 75.5422] }, { "name": "Baghapurana", "coords": [30.6773, 75.0805] } ] },
     { "busNumber": "BUS-PN01-1237", "source": { "name": "Amritsar", "coords": [31.6339, 74.8722] }, "destination": { "name": "Sangrur", "coords": [30.2526, 75.8378] }, "departureTime": "09:30", "arrivalTime": "14:30", "driverName": "Mr. Mishra", "stops": [ { "name": "Jalandhar", "coords": [31.3260, 75.5762] }, { "name": "Ludhiana", "coords": [30.9010, 75.8573] }, { "name": "Malerkotla", "coords": [30.5253, 75.8812] } ] },
     { "busNumber": "BUS-GJ05-5681", "source": { "name": "Jalandhar", "coords": [31.3260, 75.5762] }, "destination": { "name": "Barnala", "coords": [30.3782, 75.5422] }, "departureTime": "12:30", "arrivalTime": "15:00", "driverName": "Mr. Tiwari", "stops": [ { "name": "Nakodar", "coords": [31.1260, 75.4740] }, { "name": "Moga", "coords": [30.8038, 75.1713] } ] },
     { "busNumber": "BUS-PN01-5558", "source": { "name": "Ludhiana", "coords": [30.9010, 75.8573] }, "destination": { "name": "Pathankot", "coords": [32.2687, 75.6496] }, "departureTime": "14:00", "arrivalTime": "18:00", "driverName": "Mr. Dubey", "stops": [ { "name": "Jalandhar", "coords": [31.3260, 75.5762] }, { "name": "Gurdaspur", "coords": [32.0428, 75.4057] } ] },
     { "busNumber": "BUS-PB08-1114", "source": { "name": "Patiala", "coords": [30.3398, 76.3869] }, "destination": { "name": "Gurdaspur", "coords": [32.0428, 75.4057] }, "departureTime": "15:30", "arrivalTime": "20:00", "driverName": "Mr. Pandey", "stops": [ { "name": "Ludhiana", "coords": [30.9010, 75.8573] }, { "name": "Jalandhar", "coords": [31.3260, 75.5762] }, { "name": "Pathankot", "coords": [32.2687, 75.6496] } ] },
     { "busNumber": "BUS-PB08-2225", "source": { "name": "Faridkot", "coords": [30.6752, 74.7543] }, "destination": { "name": "Ropar", "coords": [30.9660, 76.5250] }, "departureTime": "16:00", "arrivalTime": "19:30", "driverName": "Mr. Chauhan", "stops": [ { "name": "Ludhiana", "coords": [30.9010, 75.8573] }, { "name": "Mohali", "coords": [30.7042, 76.7179] } ] },
     { "busNumber": "BUS-PN23-8891", "source": { "name": "Bathinda", "coords": [30.2110, 74.9455] }, "destination": { "name": "Amritsar", "coords": [31.6339, 74.8722] }, "departureTime": "10:45", "arrivalTime": "14:45", "driverName": "Mr. Sisodia", "stops": [ { "name": "Kotkapura", "coords": [30.5841, 74.8217] }, { "name": "Faridkot", "coords": [30.6752, 74.7543] }, { "name": "Harike", "coords": [31.1500, 74.9333] } ] },
     { "busNumber": "BUS-PN10-7780", "source": { "name": "Ludhiana", "coords": [30.9010, 75.8573] }, "destination": { "name": "Mohali", "coords": [30.7042, 76.7179] }, "departureTime": "16:00", "arrivalTime": "17:30", "driverName": "Mr. Tomar", "stops": [ { "name": "Sirhind", "coords": [30.6210, 76.3888] }, { "name": "Kharar", "coords": [30.7444, 76.6499] } ] },
     { "busNumber": "BUS-CH01-3336", "source": { "name": "Mohali", "coords": [30.7042, 76.7179] }, "destination": { "name": "Jalandhar", "coords": [31.3260, 75.5762] }, "departureTime": "17:00", "arrivalTime": "20:00", "driverName": "Mr. Rawat", "stops": [ { "name": "Sirhind", "coords": [30.6210, 76.3888] }, { "name": "Ludhiana", "coords": [30.9010, 75.8573] }, { "name": "Phagwara", "coords": [31.2181, 75.7725] } ] },
     { "busNumber": "BUS-PB65-4447", "source": { "name": "Pathankot", "coords": [32.2687, 75.6496] }, "destination": { "name": "Ludhiana", "coords": [30.9010, 75.8573] }, "departureTime": "18:30", "arrivalTime": "22:30", "driverName": "Mr. Gusain", "stops": [ { "name": "Gurdaspur", "coords": [32.0428, 75.4057] }, { "name": "Jalandhar", "coords": [31.3260, 75.5762] } ] },
     { "busNumber": "BUS-PB13-6669", "source": { "name": "Sangrur", "coords": [30.2526, 75.8378] }, "destination": { "name": "Patiala", "coords": [30.3398, 76.3869] }, "departureTime": "13:30", "arrivalTime": "15:00", "driverName": "Mr. Negi", "stops": [ { "name": "Bhawanigarh", "coords": [30.3951, 76.0424] } ] },
     { "busNumber": "BUS-PN01-1238", "source": { "name": "Amritsar", "coords": [31.6339, 74.8722] }, "destination": { "name": "Mohali", "coords": [30.7042, 76.7179] }, "departureTime": "10:00", "arrivalTime": "15:00", "driverName": "Mr. Bhandari", "stops": [ { "name": "Jalandhar", "coords": [31.3260, 75.5762] }, { "name": "Ludhiana", "coords": [30.9010, 75.8573] }, { "name": "Sirhind", "coords": [30.6210, 76.3888] } ] },
     { "busNumber": "BUS-GJ05-5682", "source": { "name": "Jalandhar", "coords": [31.3260, 75.5762] }, "destination": { "name": "Sangrur", "coords": [30.2526, 75.8378] }, "departureTime": "13:30", "arrivalTime": "16:30", "driverName": "Mr. Bisht", "stops": [ { "name": "Ludhiana", "coords": [30.9010, 75.8573] }, { "name": "Malerkotla", "coords": [30.5253, 75.8812] } ] },
     { "busNumber": "BUS-PN01-5559", "source": { "name": "Ludhiana", "coords": [30.9010, 75.8573] }, "destination": { "name": "Bathinda", "coords": [30.2110, 74.9455] }, "departureTime": "15:00", "arrivalTime": "17:30", "driverName": "Mr. Rana", "stops": [ { "name": "Moga", "coords": [30.8038, 75.1713] }, { "name": "Barnala", "coords": [30.3782, 75.5422] } ] },
     { "busNumber": "BUS-PB08-1115", "source": { "name": "Patiala", "coords": [30.3398, 76.3869] }, "destination": { "name": "Barnala", "coords": [30.3782, 75.5422] }, "departureTime": "16:30", "arrivalTime": "18:00", "driverName": "Mr. Thapa", "stops": [ { "name": "Sangrur", "coords": [30.2526, 75.8378] }, { "name": "Dhuri", "coords": [30.3671, 75.8679] } ] },
     { "busNumber": "BUS-PB08-2226", "source": { "name": "Faridkot", "coords": [30.6752, 74.7543] }, "destination": { "name": "Amritsar", "coords": [31.6339, 74.8722] }, "departureTime": "17:00", "arrivalTime": "20:00", "driverName": "Mr. Gurung", "stops": [ { "name": "Harike", "coords": [31.1500, 74.9333] }, { "name": "Tarn Taran", "coords": [31.4503, 74.9259] } ] },
     { "busNumber": "BUS-PN23-8892", "source": { "name": "Bathinda", "coords": [30.2110, 74.9455] }, "destination": { "name": "Jalandhar", "coords": [31.3260, 75.5762] }, "departureTime": "12:45", "arrivalTime": "16:15", "driverName": "Mr. Rai", "stops": [ { "name": "Moga", "coords": [30.8038, 75.1713] }, { "name": "Ludhiana", "coords": [30.9010, 75.8573] } ] },
     { "busNumber": "BUS-PN10-7781", "source": { "name": "Ludhiana", "coords": [30.9010, 75.8573] }, "destination": { "name": "Ropar", "coords": [30.9660, 76.5250] }, "departureTime": "17:00", "arrivalTime": "18:30", "driverName": "Mr. Limbu", "stops": [ { "name": "Samrala", "coords": [30.8359, 76.1923] } ] },
     { "busNumber": "BUS-CH01-3337", "source": { "name": "Mohali", "coords": [30.7042, 76.7179] }, "destination": { "name": "Pathankot", "coords": [32.2687, 75.6496] }, "departureTime": "18:00", "arrivalTime": "22:00", "driverName": "Mr. Tamang", "stops": [ { "name": "Ropar", "coords": [30.9660, 76.5250] }, { "name": "Hoshiarpur", "coords": [31.5300, 75.9100] } ] },
     { "busNumber": "BUS-PB65-4448", "source": { "name": "Pathankot", "coords": [32.2687, 75.6496] }, "destination": { "name": "Amritsar", "coords": [31.6339, 74.8722] }, "departureTime": "19:30", "arrivalTime": "22:00", "driverName": "Mr. Sherpa", "stops": [ { "name": "Gurdaspur", "coords": [32.0428, 75.4057] }, { "name": "Batala", "coords": [31.8186, 75.2023] } ] },
     { "busNumber": "BUS-PB13-6670", "source": { "name": "Sangrur", "coords": [30.2526, 75.8378] }, "destination": { "name": "Jalandhar", "coords": [31.3260, 75.5762] }, "departureTime": "14:30", "arrivalTime": "17:30", "driverName": "Mr. Ghale", "stops": [ { "name": "Ludhiana", "coords": [30.9010, 75.8573] }, { "name": "Phagwara", "coords": [31.2181, 75.7725] } ] },
     { "busNumber": "BUS-PN01-1239", "source": { "name": "Amritsar", "coords": [31.6339, 74.8722] }, "destination": { "name": "Barnala", "coords": [30.3782, 75.5422] }, "departureTime": "11:00", "arrivalTime": "15:00", "driverName": "Mr. Magar", "stops": [ { "name": "Moga", "coords": [30.8038, 75.1713] } ] },
     { "busNumber": "BUS-GJ05-5683", "source": { "name": "Jalandhar", "coords": [31.3260, 75.5762] }, "destination": { "name": "Moga", "coords": [30.8038, 75.1713] }, "departureTime": "14:30", "arrivalTime": "16:30", "driverName": "Mr. Shrestha", "stops": [ { "name": "Nakodar", "coords": [31.1260, 75.4740] }, { "name": "Shahkot", "coords": [31.0800, 75.3400] } ] },
     { "busNumber": "BUS-PN01-5560", "source": { "name": "Ludhiana", "coords": [30.9010, 75.8573] }, "destination": { "name": "Faridkot", "coords": [30.6752, 74.7543] }, "departureTime": "16:00", "arrivalTime": "18:00", "driverName": "Mr. Karki", "stops": [ { "name": "Moga", "coords": [30.8038, 75.1713] }, { "name": "Kot Ise Khan", "coords": [30.9012, 75.0312] } ] },
     { "busNumber": "BUS-PB08-1116", "source": { "name": "Patiala", "coords": [30.3398, 76.3869] }, "destination": { "name": "Pathankot", "coords": [32.2687, 75.6496] }, "departureTime": "17:30", "arrivalTime": "22:00", "driverName": "Mr. Adhikari", "stops": [ { "name": "Ludhiana", "coords": [30.9010, 75.8573] }, { "name": "Jalandhar", "coords": [31.3260, 75.5762] }, { "name": "Gurdaspur", "coords": [32.0428, 75.4057] } ] },
     { "busNumber": "BUS-PB08-2227", "source": { "name": "Faridkot", "coords": [30.6752, 74.7543] }, "destination": { "name": "Jalandhar", "coords": [31.3260, 75.5762] }, "departureTime": "18:00", "arrivalTime": "21:00", "driverName": "Mr. Bhattarai", "stops": [ { "name": "Moga", "coords": [30.8038, 75.1713] }, { "name": "Nakodar", "coords": [31.1260, 75.4740] } ] },
     { "busNumber": "BUS-PN23-8893", "source": { "name": "Bathinda", "coords": [30.2110, 74.9455] }, "destination": { "name": "Mohali", "coords": [30.7042, 76.7179] }, "departureTime": "14:45", "arrivalTime": "17:15", "driverName": "Mr. Yadav", "stops": [ { "name": "Sangrur", "coords": [30.2526, 75.8378] }, { "name": "Patiala", "coords": [30.3398, 76.3869] } ] },
     { "busNumber": "BUS-PN10-7782", "source": { "name": "Ludhiana", "coords": [30.9010, 75.8573] }, "destination": { "name": "Sangrur", "coords": [30.2526, 75.8378] }, "departureTime": "18:00", "arrivalTime": "20:00", "driverName": "Mr. Singh", "stops": [ { "name": "Malerkotla", "coords": [30.5253, 75.8812] } ] },
     { "busNumber": "BUS-CH01-3338", "source": { "name": "Mohali", "coords": [30.7042, 76.7179] }, "destination": { "name": "Amritsar", "coords": [31.6339, 74.8722] }, "departureTime": "19:00", "arrivalTime": "23:00", "driverName": "Mr. Sharma", "stops": [ { "name": "Ludhiana", "coords": [30.9010, 75.8573] }, { "name": "Jalandhar", "coords": [31.3260, 75.5762] }, { "name": "Beas", "coords": [31.5177, 75.2916] } ] },
     { "busNumber": "BUS-PB65-4449", "source": { "name": "Pathankot", "coords": [32.2687, 75.6496] }, "destination": { "name": "Jalandhar", "coords": [31.3260, 75.5762] }, "departureTime": "20:30", "arrivalTime": "23:00", "driverName": "Mr. Gupta", "stops": [ { "name": "Mukerian", "coords": [31.9500, 75.6167] }, { "name": "Dasuya", "coords": [31.8167, 75.6500] } ] },
     { "busNumber": "BUS-PB13-6671", "source": { "name": "Sangrur", "coords": [30.2526, 75.8378] }, "destination": { "name": "Ludhiana", "coords": [30.9010, 75.8573] }, "departureTime": "16:30", "arrivalTime": "18:30", "driverName": "Mr. Verma", "stops": [ { "name": "Malerkotla", "coords": [30.5253, 75.8812] }, { "name": "Ahmedgarh", "coords": [30.6900, 75.8500] } ] },
     { "busNumber": "BUS-PN01-1240", "source": { "name": "Amritsar", "coords": [31.6339, 74.8722] }, "destination": { "name": "Ropar", "coords": [30.9660, 76.5250] }, "departureTime": "12:00", "arrivalTime": "16:00", "driverName": "Mr. Kumar", "stops": [ { "name": "Jalandhar", "coords": [31.3260, 75.5762] }, { "name": "Phagwara", "coords": [31.2181, 75.7725] }, { "name": "Nawanshahr", "coords": [31.1250, 76.1150] } ] },
     { "busNumber": "BUS-GJ05-5684", "source": { "name": "Jalandhar", "coords": [31.3260, 75.5762] }, "destination": { "name": "Gurdaspur", "coords": [32.0428, 75.4057] }, "departureTime": "15:30", "arrivalTime": "17:30", "driverName": "Mr. Reddy", "stops": [ { "name": "Tanda", "coords": [31.6833, 75.6167] }, { "name": "Dasuya", "coords": [31.8167, 75.6500] }, { "name": "Mukerian", "coords": [31.9500, 75.6167] } ] },
     { "busNumber": "BUS-PN01-5561", "source": { "name": "Ludhiana", "coords": [30.9010, 75.8573] }, "destination": { "name": "Moga", "coords": [30.8038, 75.1713] }, "departureTime": "17:00", "arrivalTime": "18:30", "driverName": "Mr. Patel", "stops": [ { "name": "Jagraon", "coords": [30.7800, 75.4800] } ] },
     { "busNumber": "BUS-PB08-1117", "source": { "name": "Patiala", "coords": [30.3398, 76.3869] }, "destination": { "name": "Faridkot", "coords": [30.6752, 74.7543] }, "departureTime": "18:30", "arrivalTime": "20:30", "driverName": "Mr. Khan", "stops": [ { "name": "Sangrur", "coords": [30.2526, 75.8378] }, { "name": "Barnala", "coords": [30.3782, 75.5422] }, { "name": "Kotkapura", "coords": [30.5841, 74.8217] } ] },
     { "busNumber": "BUS-PB08-2228", "source": { "name": "Faridkot", "coords": [30.6752, 74.7543] }, "destination": { "name": "Bathinda", "coords": [30.2110, 74.9455] }, "departureTime": "19:00", "arrivalTime": "20:00", "driverName": "Mr. Joshi", "stops": [ { "name": "Kotkapura", "coords": [30.5841, 74.8217] } ] },
     { "busNumber": "BUS-PN23-8894", "source": { "name": "Bathinda", "coords": [30.2110, 74.9455] }, "destination": { "name": "Pathankot", "coords": [32.2687, 75.6496] }, "departureTime": "16:45", "arrivalTime": "22:15", "driverName": "Mr. Desai", "stops": [ { "name": "Faridkot", "coords": [30.6752, 74.7543] }, { "name": "Amritsar", "coords": [31.6339, 74.8722] }, { "name": "Gurdaspur", "coords": [32.0428, 75.4057] } ] },
     { "busNumber": "BUS-PN10-7783", "source": { "name": "Ludhiana", "coords": [30.9010, 75.8573] }, "destination": { "name": "Barnala", "coords": [30.3782, 75.5422] }, "departureTime": "19:00", "arrivalTime": "20:30", "driverName": "Mr. Menon", "stops": [ { "name": "Raikot", "coords": [30.6500, 75.6000] } ] },
     { "busNumber": "BUS-CH01-3339", "source": { "name": "Mohali", "coords": [30.7042, 76.7179] }, "destination": { "name": "Sangrur", "coords": [30.2526, 75.8378] }, "departureTime": "20:00", "arrivalTime": "22:00", "driverName": "Mr. Iyer", "stops": [ { "name": "Patiala", "coords": [30.3398, 76.3869] } ] },
     { "busNumber": "BUS-PB65-4450", "source": { "name": "Pathankot", "coords": [32.2687, 75.6496] }, "destination": { "name": "Patiala", "coords": [30.3398, 76.3869] }, "departureTime": "21:30", "arrivalTime": "02:00", "driverName": "Mr. Nair", "stops": [ { "name": "Jalandhar", "coords": [31.3260, 75.5762] }, { "name": "Ludhiana", "coords": [30.9010, 75.8573] }, { "name": "Sirhind", "coords": [30.6210, 76.3888] } ] },
     { "busNumber": "BUS-PB13-6672", "source": { "name": "Sangrur", "coords": [30.2526, 75.8378] }, "destination": { "name": "Amritsar", "coords": [31.6339, 74.8722] }, "departureTime": "18:30", "arrivalTime": "23:30", "driverName": "Mr. Rao", "stops": [ { "name": "Ludhiana", "coords": [30.9010, 75.8573] }, { "name": "Jalandhar", "coords": [31.3260, 75.5762] } ] },
     { "busNumber": "BUS-PN01-1241", "source": { "name": "Amritsar", "coords": [31.6339, 74.8722] }, "destination": { "name": "Gurdaspur", "coords": [32.0428, 75.4057] }, "departureTime": "13:00", "arrivalTime": "15:00", "driverName": "Mr. Pillai", "stops": [ { "name": "Batala", "coords": [31.8186, 75.2023] } ] },
     { "busNumber": "BUS-GJ05-5685", "source": { "name": "Jalandhar", "coords": [31.3260, 75.5762] }, "destination": { "name": "Ropar", "coords": [30.9660, 76.5250] }, "departureTime": "16:30", "arrivalTime": "18:30", "driverName": "Mr. Chawla", "stops": [ { "name": "Phagwara", "coords": [31.2181, 75.7725] }, { "name": "Nawanshahr", "coords": [31.1250, 76.1150] } ] },
     { "busNumber": "BUS-PN01-5562", "source": { "name": "Ludhiana", "coords": [30.9010, 75.8573] }, "destination": { "name": "Gurdaspur", "coords": [32.0428, 75.4057] }, "departureTime": "18:00", "arrivalTime": "21:00", "driverName": "Mr. Bedi", "stops": [ { "name": "Phagwara", "coords": [31.2181, 75.7725] }, { "name": "Jalandhar", "coords": [31.3260, 75.5762] }, { "name": "Batala", "coords": [31.8186, 75.2023] } ] },
     { "busNumber": "BUS-PB08-1118", "source": { "name": "Patiala", "coords": [30.3398, 76.3869] }, "destination": { "name": "Moga", "coords": [30.8038, 75.1713] }, "departureTime": "19:30", "arrivalTime": "21:30", "driverName": "Mr. Puri", "stops": [ { "name": "Sangrur", "coords": [30.2526, 75.8378] }, { "name": "Barnala", "coords": [30.3782, 75.5422] } ] },
     { "busNumber": "BUS-PB08-2229", "source": { "name": "Faridkot", "coords": [30.6752, 74.7543] }, "destination": { "name": "Sangrur", "coords": [30.2526, 75.8378] }, "departureTime": "20:00", "arrivalTime": "22:00", "driverName": "Mr. Sood", "stops": [ { "name": "Moga", "coords": [30.8038, 75.1713] }, { "name": "Barnala", "coords": [30.3782, 75.5422] } ] },
     { "busNumber": "BUS-PN23-8895", "source": { "name": "Bathinda", "coords": [30.2110, 74.9455] }, "destination": { "name": "Ropar", "coords": [30.9660, 76.5250] }, "departureTime": "18:45", "arrivalTime": "21:45", "driverName": "Mr. Tandon", "stops": [ { "name": "Patiala", "coords": [30.3398, 76.3869] }, { "name": "Mohali", "coords": [30.7042, 76.7179] } ] },
     { "busNumber": "BUS-PN10-7784", "source": { "name": "Ludhiana", "coords": [30.9010, 75.8573] }, "destination": { "name": "Pathankot", "coords": [32.2687, 75.6496] }, "departureTime": "20:00", "arrivalTime": "23:59", "driverName": "Mr. Mehra", "stops": [ { "name": "Jalandhar", "coords": [31.3260, 75.5762] }, { "name": "Mukerian", "coords": [31.9500, 75.6167] } ] },
     { "busNumber": "BUS-CH01-3340", "source": { "name": "Mohali", "coords": [30.7042, 76.7179] }, "destination": { "name": "Barnala", "coords": [30.3782, 75.5422] }, "departureTime": "21:00", "arrivalTime": "23:00", "driverName": "Mr. Khanna", "stops": [ { "name": "Patiala", "coords": [30.3398, 76.3869] }, { "name": "Sangrur", "coords": [30.2526, 75.8378] } ] },
     { "busNumber": "BUS-PB65-4451", "source": { "name": "Pathankot", "coords": [32.2687, 75.6496] }, "destination": { "name": "Sangrur", "coords": [30.2526, 75.8378] }, "departureTime": "22:30", "arrivalTime": "04:00", "driverName": "Mr. Bajaj", "stops": [ { "name": "Jalandhar", "coords": [31.3260, 75.5762] }, { "name": "Ludhiana", "coords": [30.9010, 75.8573] } ] },
     { "busNumber": "BUS-PB13-6673", "source": { "name": "Sangrur", "coords": [30.2526, 75.8378] }, "destination": { "name": "Mohali", "coords": [30.7042, 76.7179] }, "departureTime": "20:30", "arrivalTime": "22:30", "driverName": "Mr. Dhawan", "stops": [ { "name": "Patiala", "coords": [30.3398, 76.3869] } ] },
     { "busNumber": "BUS-PN01-1242", "source": { "name": "Amritsar", "coords": [31.6339, 74.8722] }, "destination": { "name": "Moga", "coords": [30.8038, 75.1713] }, "departureTime": "14:00", "arrivalTime": "17:00", "driverName": "Mr. Kashyap", "stops": [ { "name": "Harike", "coords": [31.1500, 74.9333] }, { "name": "Zira", "coords": [30.9686, 74.9933] } ] },
     { "busNumber": "BUS-GJ05-5686", "source": { "name": "Jalandhar", "coords": [31.3260, 75.5762] }, "destination": { "name": "Faridkot", "coords": [30.6752, 74.7543] }, "departureTime": "17:30", "arrivalTime": "19:30", "driverName": "Mr. Gill", "stops": [ { "name": "Nakodar", "coords": [31.1260, 75.4740] }, { "name": "Moga", "coords": [30.8038, 75.1713] } ] },
     { "busNumber": "BUS-PN01-5563", "source": { "name": "Ludhiana", "coords": [30.9010, 75.8573] }, "destination": { "name": "Bathinda", "coords": [30.2110, 74.9455] }, "departureTime": "19:00", "arrivalTime": "21:00", "driverName": "Mr. Sethi", "stops": [ { "name": "Jagraon", "coords": [30.7800, 75.4800] }, { "name": "Moga", "coords": [30.8038, 75.1713] }, { "name": "Barnala", "coords": [30.3782, 75.5422] } ] },
     { "busNumber": "BUS-PB08-1119", "source": { "name": "Patiala", "coords": [30.3398, 76.3869] }, "destination": { "name": "Barnala", "coords": [30.3782, 75.5422] }, "departureTime": "20:30", "arrivalTime": "22:00", "driverName": "Mr. Goel", "stops": [ { "name": "Sangrur", "coords": [30.2526, 75.8378] } ] },
     { "busNumber": "BUS-PB08-2230", "source": { "name": "Faridkot", "coords": [30.6752, 74.7543] }, "destination": { "name": "Ropar", "coords": [30.9660, 76.5250] }, "departureTime": "21:00", "arrivalTime": "23:59", "driverName": "Mr. Jain", "stops": [ { "name": "Ludhiana", "coords": [30.9010, 75.8573] }, { "name": "Mohali", "coords": [30.7042, 76.7179] } ] },
     { "busNumber": "BUS-PN23-8896", "source": { "name": "Bathinda", "coords": [30.2110, 74.9455] }, "destination": { "name": "Gurdaspur", "coords": [32.0428, 75.4057] }, "departureTime": "20:45", "arrivalTime": "02:15", "driverName": "Mr. Bhatia", "stops": [ { "name": "Amritsar", "coords": [31.6339, 74.8722] }, { "name": "Batala", "coords": [31.8186, 75.2023] } ] },
     { "busNumber": "BUS-PN10-7785", "source": { "name": "Ludhiana", "coords": [30.9010, 75.8573] }, "destination": { "name": "Amritsar", "coords": [31.6339, 74.8722] }, "departureTime": "21:00", "arrivalTime": "23:59", "driverName": "Mr. Mishra", "stops": [ { "name": "Phagwara", "coords": [31.2181, 75.7725] }, { "name": "Jalandhar", "coords": [31.3260, 75.5762] }, { "name": "Beas", "coords": [31.5177, 75.2916] } ] },
     { "busNumber": "BUS-CH01-3341", "source": { "name": "Mohali", "coords": [30.7042, 76.7179] }, "destination": { "name": "Moga", "coords": [30.8038, 75.1713] }, "departureTime": "22:00", "arrivalTime": "23:59", "driverName": "Mr. Tiwari", "stops": [ { "name": "Ludhiana", "coords": [30.9010, 75.8573] }, { "name": "Jagraon", "coords": [30.7800, 75.4800] } ] },
     { "busNumber": "BUS-PB65-4452", "source": { "name": "Pathankot", "coords": [32.2687, 75.6496] }, "destination": { "name": "Bathinda", "coords": [30.2110, 74.9455] }, "departureTime": "23:30", "arrivalTime": "05:00", "driverName": "Mr. Dubey", "stops": [ { "name": "Amritsar", "coords": [31.6339, 74.8722] }, { "name": "Faridkot", "coords": [30.6752, 74.7543] } ] },
     { "busNumber": "BUS-PB13-6674", "source": { "name": "Sangrur", "coords": [30.2526, 75.8378] }, "destination": { "name": "Gurdaspur", "coords": [32.0428, 75.4057] }, "departureTime": "22:30", "arrivalTime": "04:30", "driverName": "Mr. Pandey", "stops": [ { "name": "Ludhiana", "coords": [30.9010, 75.8573] }, { "name": "Jalandhar", "coords": [31.3260, 75.5762] } ] },
     { "busNumber": "BUS-PN01-1243", "source": { "name": "Amritsar", "coords": [31.6339, 74.8722] }, "destination": { "name": "Faridkot", "coords": [30.6752, 74.7543] }, "departureTime": "15:00", "arrivalTime": "18:00", "driverName": "Mr. Chauhan", "stops": [ { "name": "Tarn Taran", "coords": [31.4503, 74.9259] }, { "name": "Harike", "coords": [31.1500, 74.9333] } ] },
     { "busNumber": "BUS-GJ05-5687", "source": { "name": "Jalandhar", "coords": [31.3260, 75.5762] }, "destination": { "name": "Bathinda", "coords": [30.2110, 74.9455] }, "departureTime": "18:30", "arrivalTime": "21:30", "driverName": "Mr. Sisodia", "stops": [ { "name": "Moga", "coords": [30.8038, 75.1713] }, { "name": "Barnala", "coords": [30.3782, 75.5422] } ] },
     { "busNumber": "BUS-PN01-5564", "source": { "name": "Ludhiana", "coords": [30.9010, 75.8573] }, "destination": { "name": "Ropar", "coords": [30.9660, 76.5250] }, "departureTime": "20:00", "arrivalTime": "21:30", "driverName": "Mr. Tomar", "stops": [ { "name": "Samrala", "coords": [30.8359, 76.1923] } ] },
    { "busNumber": "BUS-PB08-1120", "source": { "name": "Patiala", "coords": [30.3398, 76.3869] }, "destination": { "name": "Sangrur", "coords": [30.2526, 75.8378] }, "departureTime": "21:30", "arrivalTime": "23:00", "driverName": "Mr. Rawat", "stops": [ { "name": "Bhawanigarh", "coords": [30.3951, 76.0424] } ] },
    { "busNumber": "BUS-PB08-2231", "source": { "name": "Faridkot", "coords": [30.6752, 74.7543] }, "destination": { "name": "Mohali", "coords": [30.7042, 76.7179] }, "departureTime": "22:00", "arrivalTime": "01:00", "driverName": "Mr. Gusain", "stops": [ { "name": "Moga", "coords": [30.8038, 75.1713] }, { "name": "Ludhiana", "coords": [30.9010, 75.8573] } ] },
    { "busNumber": "BUS-PN23-8897", "source": { "name": "Bathinda", "coords": [30.2110, 74.9455] }, "destination": { "name": "Amritsar", "coords": [31.6339, 74.8722] }, "departureTime": "22:45", "arrivalTime": "02:45", "driverName": "Mr. Negi", "stops": [ { "name": "Faridkot", "coords": [30.6752, 74.7543] }, { "name": "Tarn Taran", "coords": [31.4503, 74.9259] } ] },
    { "busNumber": "BUS-PN10-7786", "source": { "name": "Ludhiana", "coords": [30.9010, 75.8573] }, "destination": { "name": "Pathankot", "coords": [32.2687, 75.6496] }, "departureTime": "22:00", "arrivalTime": "02:00", "driverName": "Mr. Bhandari", "stops": [ { "name": "Jalandhar", "coords": [31.3260, 75.5762] }, { "name": "Dasuya", "coords": [31.8167, 75.6500] }, { "name": "Mukerian", "coords": [31.9500, 75.6167] } ] },
    { "busNumber": "BUS-CH01-3342", "source": { "name": "Mohali", "coords": [30.7042, 76.7179] }, "destination": { "name": "Patiala", "coords": [30.3398, 76.3869] }, "departureTime": "23:00", "arrivalTime": "00:30", "driverName": "Mr. Bisht", "stops": [ { "name": "Rajpura", "coords": [30.4807, 76.5919] } ] },
    { "busNumber": "BUS-PB65-4453", "source": { "name": "Pathankot", "coords": [32.2687, 75.6496] }, "destination": { "name": "Mohali", "coords": [30.7042, 76.7179] }, "departureTime": "00:30", "arrivalTime": "04:30", "driverName": "Mr. Rana", "stops": [ { "name": "Hoshiarpur", "coords": [31.5300, 75.9100] }, { "name": "Ropar", "coords": [30.9660, 76.5250] } ] },
    { "busNumber": "BUS-PB13-6675", "source": { "name": "Sangrur", "coords": [30.2526, 75.8378] }, "destination": { "name": "Pathankot", "coords": [32.2687, 75.6496] }, "departureTime": "23:30", "arrivalTime": "05:30", "driverName": "Mr. Thapa", "stops": [ { "name": "Ludhiana", "coords": [30.9010, 75.8573] }, { "name": "Jalandhar", "coords": [31.3260, 75.5762] }, { "name": "Gurdaspur", "coords": [32.0428, 75.4057] } ] },
    { "busNumber": "BUS-PN01-1244", "source": { "name": "Amritsar", "coords": [31.6339, 74.8722] }, "destination": { "name": "Patiala", "coords": [30.3398, 76.3869] }, "departureTime": "16:00", "arrivalTime": "20:00", "driverName": "Mr. Gurung", "stops": [ { "name": "Jalandhar", "coords": [31.3260, 75.5762] }, { "name": "Ludhiana", "coords": [30.9010, 75.8573] }, { "name": "Sirhind", "coords": [30.6210, 76.3888] } ] },
    { "busNumber": "BUS-GJ05-5688", "source": { "name": "Jalandhar", "coords": [31.3260, 75.5762] }, "destination": { "name": "Amritsar", "coords": [31.6339, 74.8722] }, "departureTime": "19:30", "arrivalTime": "21:00", "driverName": "Mr. Rai", "stops": [ { "name": "Kartarpur", "coords": [31.4426, 75.4984] }, { "name": "Beas", "coords": [31.5177, 75.2916] } ] },
    { "busNumber": "BUS-PN01-5565", "source": { "name": "Ludhiana", "coords": [30.9010, 75.8573] }, "destination": { "name": "Mohali", "coords": [30.7042, 76.7179] }, "departureTime": "21:00", "arrivalTime": "22:30", "driverName": "Mr. Limbu", "stops": [ { "name": "Sirhind", "coords": [30.6210, 76.3888] }, { "name": "Kharar", "coords": [30.7444, 76.6499] } ] },
    { "busNumber": "BUS-PB08-1121", "source": { "name": "Patiala", "coords": [30.3398, 76.3869] }, "destination": { "name": "Jalandhar", "coords": [31.3260, 75.5762] }, "departureTime": "22:30", "arrivalTime": "00:30", "driverName": "Mr. Tamang", "stops": [ { "name": "Sirhind", "coords": [30.6210, 76.3888] }, { "name": "Ludhiana", "coords": [30.9010, 75.8573] } ] },
    { "busNumber": "BUS-PB08-2232", "source": { "name": "Faridkot", "coords": [30.6752, 74.7543] }, "destination": { "name": "Gurdaspur", "coords": [32.0428, 75.4057] }, "departureTime": "23:00", "arrivalTime": "03:00", "driverName": "Mr. Sherpa", "stops": [ { "name": "Amritsar", "coords": [31.6339, 74.8722] }, { "name": "Batala", "coords": [31.8186, 75.2023] } ] },
    { "busNumber": "BUS-PN23-8898", "source": { "name": "Bathinda", "coords": [30.2110, 74.9455] }, "destination": { "name": "Moga", "coords": [30.8038, 75.1713] }, "departureTime": "23:45", "arrivalTime": "01:00", "driverName": "Mr. Ghale", "stops": [ { "name": "Goniana", "coords": [30.3167, 74.9167] } ] },
    { "busNumber": "BUS-PN10-7787", "source": { "name": "Ludhiana", "coords": [30.9010, 75.8573] }, "destination": { "name": "Faridkot", "coords": [30.6752, 74.7543] }, "departureTime": "23:00", "arrivalTime": "01:00", "driverName": "Mr. Shrestha", "stops": [ { "name": "Moga", "coords": [30.8038, 75.1713] } ] },
    { "busNumber": "BUS-CH01-3343", "source": { "name": "Mohali", "coords": [30.7042, 76.7179] }, "destination": { "name": "Ludhiana", "coords": [30.9010, 75.8573] }, "departureTime": "00:00", "arrivalTime": "01:30", "driverName": "Mr. Karki", "stops": [ { "name": "Sirhind", "coords": [30.6210, 76.3888] } ] },
    { "busNumber": "BUS-PB65-4454", "source": { "name": "Pathankot", "coords": [32.2687, 75.6496] }, "destination": { "name": "Moga", "coords": [30.8038, 75.1713] }, "departureTime": "01:30", "arrivalTime": "06:00", "driverName": "Mr. Adhikari", "stops": [ { "name": "Jalandhar", "coords": [31.3260, 75.5762] }, { "name": "Nakodar", "coords": [31.1260, 75.4740] } ] },
    { "busNumber": "BUS-PB13-6676", "source": { "name": "Sangrur", "coords": [30.2526, 75.8378] }, "destination": { "name": "Faridkot", "coords": [30.6752, 74.7543] }, "departureTime": "00:30", "arrivalTime": "03:00", "driverName": "Mr. Bhattarai", "stops": [ { "name": "Barnala", "coords": [30.3782, 75.5422] }, { "name": "Moga", "coords": [30.8038, 75.1713] } ] }

];


/**
 * Helper function to fetch and profile a route from Mapbox.
 * (Copied from simulation.js for use in the seeder)
 */
async function getAndProfileRoute(bus) {
    const allStopsCoords = [
        [bus.source.coords[1], bus.source.coords[0]],
        ...bus.stops.map(stop => [stop.coords[1], stop.coords[0]]),
        [bus.destination.coords[1], bus.destination.coords[0]]
    ];
    const waypoints = allStopsCoords.join(';');
    const url = `https://api.mapbox.com/directions/v5/mapbox/driving/${waypoints}?geometries=geojson&overview=full&access_token=${process.env.MAPBOX_ACCESS_TOKEN}`;

    try {
        const response = await axios.get(url);
        const route = response.data.routes[0];
        const routeLine = turf.lineString(route.geometry.coordinates);
        const totalDistance = turf.length(routeLine); // in km

        const stopDistances = allStopsCoords.map(coords => {
            const stopPoint = turf.point(coords);
            const snapped = turf.nearestPointOnLine(routeLine, stopPoint);
            return snapped.properties.location;
        });

        return {
            coordinates: route.geometry.coordinates,
            totalDistance, // in km
            mapboxDuration: route.duration / 60, // in minutes
            stopDistances, // array of distances along the route for each stop
        };
    } catch (error) {
        // Log the error but don't crash the whole script
        console.error(`Error fetching route for ${bus.busNumber}:`, error.message);
        return null;
    }
}


const seedDB = async () => {
    try {
        await mongoose.connect(process.env.ATLAS_URI);
        console.log("MongoDB connected for seeding...");

        console.log("Deleting old bus data...");
        await Bus.deleteMany({});
        console.log("Old data deleted.");

        console.log("Fetching routes and preparing new bus data... (This may take a moment)");
        
        // Use Promise.all to fetch all routes in parallel
        const busesWithRoutes = await Promise.all(busData.map(async (bus) => {
            // Add a small delay to avoid hitting Mapbox rate limits too hard
            await new Promise(resolve => setTimeout(resolve, 50)); 
            const routeInfo = await getAndProfileRoute(bus);

            if (routeInfo) {
                const { coordinates, ...profile } = routeInfo;
                const maxPassengers = Math.floor(Math.random() * 21) + 30; // 30-50

                return {
                    ...bus,
                    // Set initial dynamic values
                    coordinates: [bus.source.coords[1], bus.source.coords[0]], // Start at source
                    passengers: `${Math.floor(Math.random() * 10)}/${maxPassengers}`,
                    status: 'Inactive',
                    eta: 'Scheduled',
                    nextStop: bus.source.name,
                    // Add the pre-calculated route info
                    routeGeometry: {
                        coordinates: coordinates,
                    },
                    routeProfile: profile,
                };
            }
            return null; // Return null for buses where route fetching failed
        }));

        // Filter out any buses that failed to get a route
        const validBuses = busesWithRoutes.filter(bus => bus !== null);

        console.log(`Successfully fetched routes for ${validBuses.length}/${busData.length} buses.`);
        console.log("Adding new bus data to the database...");
        if (validBuses.length > 0) {
            await Bus.insertMany(validBuses);
            console.log("âœ… Database seeded successfully!");
        } else {
            console.log("No valid buses to seed.");
        }

    } catch (err) {
        console.error("Error seeding the database:", err);
    } finally {
        mongoose.connection.close();
        console.log("MongoDB connection closed.");
    }
};

seedDB();